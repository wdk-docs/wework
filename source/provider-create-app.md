---
date: 2022/12/15
title: 服务商注册应用
---

# 服务商注册应用[^1]

[^1]: WW-90595

    注册第三方服务商

### 注册条件

- 拥有一个企业微信
- 用系统管理员身份在“企业微信服务商官网”进行申请

### 填写注册信息

| 信息项     | 要求及说明                                             |
| ---------- | ------------------------------------------------------ |
| 企业 Logo  | 第三方服务商的企业 Logo，小于 5M，702\*180，背景为白色 |
| 企业简介   | 描述企业所提供的服务，4-120 个字                       |
| 企业官网   | 第三方服务商的企业官网                                 |
| 联系人姓名 | -                                                      |
| 联系人手机 | -                                                      |

<a id="配置开发信息"></a>

### 配置开发信息

开发者完成注册之后，即可登录进入服务商管理后台。

在 `后台主页`->`应用管理`->`通用开发参数栏`->`点击编辑按钮`，配置基本开发信息

| 参数内容         | 说明                                                                                                        |
| ---------------- | ----------------------------------------------------------------------------------------------------------- |
| ProviderSecret   | 服务商的密钥（不同于下文的应用 secret），相关的接口调用需要使用。                                           |
| 系统事件接收 URL | 用于接收跟应用无关的系统消息(如注册完成)。(填写 URL 时需要正确响应企业微信验证 URL 的请求。请参考接收消息） |
| Token            | 可任意填写，用于生成签名,校验回调请求的合法性。                                                             |
| EncodingAESKey   | 回调消息加解密参数，是 AES 密钥的 Base64 编码，用于解密回调消息内容对应的密文。                             |

在 `后台主页`->`服务商信息`->`IP 白名单`->`点击修改按钮`，添加白名单 IP 列表

| 参数内容       | 说明                                                                                                  |
| -------------- | ----------------------------------------------------------------------------------------------------- |
| 白名单 IP 列表 | 服务商调用企业微信 API 时的合法 IP 列表，只有白名单内的 IP 才能正常调用企业微信 API，修改后立即生效。 |
|                | 支持`222.209.201.*` 这样用通配符表示 IP 段；多个 IP 以英文分号`;`分隔                                 |

## 创建应用

### 创建网页应用

注册并配置好开发信息后，即可创建应用。

企业在授权安装时，是以应用为单位进行安装。目前应用支持如下类型：

### 普通应用

用于企业 OA、生产流程等办公的场景。应用具有读通讯录、发消息等权限。此类应用根据活跃情况会被推荐。

### 通讯录应用

用于第三方维护企业通讯录的场景。此类应用对企业的通讯录拥有根部门的读写权限。为避免通讯录被多方写乱的问题，一家企业只能授权一个通讯录应用。授权后，可在企业微信管理端的通讯录助手取消授权。额外的，通讯录应用在授权时可附带另外一个普通应用，但不会被推荐。

### 创建小程序

企业微信支持小程序的运行，小程序需要先在微信小程序平台审核和发布，然后在企业微信关联，整体的步骤稍微复杂，如下：

- 注册微信小程序开发者；
- 开发微信小程序，适配企业微信帐号；
- 在微信小程序平台发布小程序；
- 在企业微信服务商后台关联小程序；
- 关联小程序的详细步骤如下：

登录服务商管理后台—进入 `应用管理`->`小程序`—>`关联小程序`—>`填写应用信息`—>`关联完成`，进入应用详情页修改并完善小程序信息。

![](https://p.qpic.cn/pic_wework/3189785124/2325502f89d8c7086df351cd773a9205025be89df6b72eee/0)

### 应用信息

#### 基本信息：

| 信息项       | 要求及说明                                                                                                                                                               |
| ------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| 应用类型     | 包括普通应用和通讯录管理应用两种类型。                                                                                                                                   |
| 应用 Logo    | 应用的 Logo，小于 5M，750\*750，在授权页会被用于展示。                                                                                                                   |
| 应用名称     | 应用的名称，建议包含品牌名，2-8 个字内。                                                                                                                                 |
| 应用标语     | 应用的宣传标语，2-10 个字内 。                                                                                                                                           |
| 应用简介     | 填写应用功能和使用场景介绍，要求 4-120 个字。                                                                                                                            |
| 分类         | 应用提供的服务类型，如客户关系、团队协同、文化建设等。一个应用只能拥有一个分类。                                                                                         |
| 通讯录权限   | 标识应用可以对授权企业的通讯录进行哪些操作，分为单个基本信息只读和通讯录基本信息只读。更详细请参考通讯录权限体系。                                                       |
| 通讯录范围   | 标识应用可以对授权企业的哪部分通讯录进行操作，分为“与可见范围一致”、“需要额外通讯录范围”。如果选择了“需要额外通讯录范围”，应用可以对企业管理员设置的额外通讯录进行操作。 |
| 成员敏感信息 | 应用可以向用户发起敏感信息授权，应用如需获取成员的手机号码、邮箱等敏感信息，可选择所需要的敏感信息。                                                                     |

> 请谨慎选择所填写的分类，用户往往会在企业微信中通过分类查找相关联的应用。

#### 开发信息：

| 参数内容         | 说明                                                                                                                                                                                                                                                                                                  |
| ---------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 应用主页         | 当从企业微信工作台进入应用时会直接跳转到对应的 URL；从微信插件（原企业号）中点击应用将始终跳转到对应的 URL（注意：默认在微信插件中不生效，需要勾选才生效）。URL 支持使用$CORPID$模板参数表示 corpid，授权或发布时企业微信会自动将其替换为授权企业的真实 corpid                                        |
| 可信域名         | 设置可信域名后支持应用的 OAuth2 授权、JSSDK 调用等                                                                                                                                                                                                                                                    |
| 安装完成回调域名 | 在第三方应用授权流程中，授权成功后会 302 跳转到该域名下的 url(详见从服务商网站发起授权应用)，返回临时授权码。企业微信跳转 URL 时，会检查该 URL 是否在此处填下的域名之下，以杜绝伪造攻击业务设置 URL 该 URL 为服务商侧的管理后台链接，授权企业的管理员可从企业微信后台的应用详情页免登录直接跳转该链接 |
| 数据回调 URL     | 用于接收托管企业微信应用的用户消息和用户事件。URL 支持使用$CORPID$模板参数表示 corpid，推送事件时企业微信会自动将其替换为授权企业的 corpid。(关于如何回调，请参考接收消息。注意验证时$CORPID$模板参数会替换为当前服务商的 corpid，校验时也应该使用 corpid 初始化解密库)                               |
| 指令回调 URL     | 系统将会把此应用的授权变更事件以及 ticket 参数等推送给此 URL。(填写 URL 时需要正确响应企业微信验证 URL 的请求。请参考接收消息）                                                                                                                                                                       |
| 自定义菜单       | 可根据需要为应用配置默认菜单                                                                                                                                                                                                                                                                          |
| Token            | 可任意填写，用于生成签名,校验回调请求的合法性。后续所有托管的企业产生的回调消息都使用该值来计算签名。                                                                                                                                                                                                 |
| EncodingAESKey   | 回调消息加解密参数，是 AES 密钥的 Base64 编码，用于解密回调消息内容对应的密文。后续所有托管的企业产生的回调消息都使用该值来解密。                                                                                                                                                                     |

创建完成之后，在“本地应用”栏可以看到该应用，点击进入此应用，可以看到应用的 SuiteId 和 SuiteSecret 等信息，这些信息可用于调用第三方应用接口。

## 测试应用

应用创建成功后，服务商可自行授权测试该应用。

> 每个应用目前仅允许 10 个不同企业微信授权测试；
> 用于测试授权的企业微信，不能再进行正式应用的授权；

目前有下面两种测试方式：

1. 在服务商管理端“本地应用”栏，找到并点击进入上一步创建的应用，点击页面右上角的“安装测试”按钮，即可进入测试授权环节。
   该测试授权流程必须响应并处理授权成功的通知的回调消息。
2. 通过"设置授权配置"将授权方式设置为“测试授权”，然后从服务商网站发起授权（参见“企业授权应用”）.

谨记，在正式对外发布应用时一定要改回来。

## 应用上线

- 应用上线前，服务商必须经过认证；
- 应用必须在上线后，才可以被企业授权安装；
- 提交上线：已认证企业微信的服务商，可进入应用管理—点击提交上线—勾选应用—提交上线。
- 企业微信团队会在 3 个工作日内完成审核，审核结果会通过“企业微信团队”通知服务商管理员。
- 上线应用：审核通过后，点击“已通过”，提交上线即可。

## 变更应用

应用在创建后，可以修改其通讯录权限等级和通讯录权限范围。但在发布后，权限等级只能下降不可提升。修改后，所有授权的企业即刻生效。
